<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X1 DOS PRIMOS | ARENA 2026</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        :root { 
            --pl-roxo: #3d195b; 
            --pl-verde: #00ff85; 
            --pl-rosa: #ff005a;
            --fundo: #000000;
            --card: #111111;
            --branco: #ffffff;
            --borda: #222222;
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--fundo); color: var(--branco); margin: 0; padding: 10px; }
        .container { max-width: 950px; margin: auto; }

        header { background: var(--pl-roxo); color: var(--branco); padding: 25px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(61, 25, 91, 0.5); border-bottom: 4px solid var(--pl-verde); }
        h1 { margin: 0; font-size: 28px; text-transform: uppercase; letter-spacing: 3px; font-weight: 900; }

        .card-table { background: var(--card); border-radius: 15px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,255,133,0.05); margin-bottom: 25px; border: 1px solid var(--borda); }
        table { width: 100%; border-collapse: collapse; }
        th { background: #080808; padding: 15px; text-align: left; font-size: 11px; color: #888; text-transform: uppercase; border-bottom: 1px solid var(--borda); }
        td { padding: 12px 15px; border-bottom: 1px solid var(--borda); font-weight: 600; color: var(--branco); }
        
        .escudo-tabela { width: 70px; height: 70px; border-radius: 50%; border: 3px solid var(--pl-roxo); object-fit: cover; vertical-align: middle; margin-right: 15px; background: #000; }

        .painel { background: var(--card); border-radius: 20px; padding: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.5); margin-bottom: 30px; border: 1px solid var(--borda); position: relative; }
        .painel::after { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: var(--pl-verde); border-radius: 20px 20px 0 0; }
        
        .selecao-times { display: flex; justify-content: space-around; align-items: center; gap: 15px; }
        .time-card { flex: 1; display: flex; flex-direction: column; align-items: center; }
        .escudo-registro { width: 160px; height: 160px; border-radius: 50%; border: 5px solid var(--pl-roxo); object-fit: cover; box-shadow: 0 8px 25px rgba(61, 25, 91, 0.6); margin-bottom: 15px; background: #000; }
        
        select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--borda); font-weight: bold; background: #000; color: var(--branco); font-size: 16px; outline: none; }
        select:focus { border-color: var(--pl-verde); }
        input { width: 90px; height: 80px; font-size: 45px; font-weight: 800; text-align: center; border: 1px solid var(--borda); border-radius: 15px; margin-top: 15px; background: #000; color: var(--pl-verde); }

        button { background: var(--pl-verde); color: #000; font-weight: 800; border-radius: 12px; border: none; padding: 18px; cursor: pointer; width: 100%; font-size: 18px; text-transform: uppercase; transition: 0.3s; margin-top: 20px; }
        button:hover { background: var(--branco); transform: translateY(-2px); }
        .whatsapp-btn { background: #25d366; color: white; margin-bottom: 25px; }

        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .stat-item { background: var(--pl-roxo); color: white; padding: 20px; border-radius: 12px; text-align: left; border-left: 5px solid var(--pl-verde); }
        .stat-item span { font-size: 10px; text-transform: uppercase; color: var(--pl-verde); display: block; font-weight: bold; }
        .stat-item strong { font-size: 20px; display: block; margin-top: 5px; }

        .history-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; text-align: left; }
        .history-box { background: var(--card); border-radius: 15px; padding: 15px; height: 250px; overflow-y: auto; border: 1px solid var(--borda); }
        .score-pill { background: #222; padding: 4px 12px; border-radius: 6px; font-weight: 800; margin: 0 10px; color: var(--pl-verde); }

        .btn-reset { background: none; color: #666; border: 1px solid #333; padding: 10px; font-size: 11px; width: auto; margin: 10px; cursor: pointer; border-radius: 5px; }
        .btn-reset:hover { color: var(--pl-rosa); border-color: var(--pl-rosa); }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>X1 DOS PRIMOS <span style="color:var(--pl-verde)">‚Ä¢ 2026</span></h1>
        </header>

        <div class="card-table">
            <table>
                <thead>
                    <tr><th>Pos</th><th>Clube</th><th>P</th><th>V</th><th>E</th><th>D</th><th>SG</th></tr>
                </thead>
                <tbody id="tabela-corpo"></tbody>
            </table>
        </div>

        <button class="whatsapp-btn" onclick="compartilharZap()">üì≤ COMPARTILHAR NO GRUPO</button>

        <div class="painel">
            <h2 style="margin:0 0 25px 0; font-size: 16px; text-transform: uppercase; letter-spacing: 1px; color: var(--pl-verde);">Registrar Resultado</h2>
            <div class="selecao-times">
                <div class="time-card">
                    <img id="img-p1" src="LSHOW69.png" class="escudo-registro">
                    <select id="p1" onchange="trocarFoto('p1')"></select>
                    <input type="number" id="gols1" value="0">
                </div>
                <div style="font-size: 30px; font-weight: 900; color: #333;">VS</div>
                <div class="time-card">
                    <img id="img-p2" src="YGOL.png" class="escudo-registro">
                    <select id="p2" onchange="trocarFoto('p2')"></select>
                    <input type="number" id="gols2" value="0">
                </div>
            </div>
            <button onclick="registrarJogo()">Confirmar Resultado</button>
        </div>

        <h3 style="text-align: left; margin-bottom: 15px; color: var(--pl-verde);">‚öîÔ∏è RAIO-X DO DUELO</h3>
        <div style="display:flex; gap:10px; margin-bottom: 20px;">
            <select id="f1" onchange="filtrarConfronto()" style="flex:1"></select>
            <select id="f2" onchange="filtrarConfronto()" style="flex:1"></select>
        </div>

        <div id="raio-x-container" class="stats-grid"></div>

        <div class="history-grid">
            <div>
                <h4 style="font-size: 12px; text-transform: uppercase; color: #888;">Jogos Selecionados</h4>
                <div class="history-box" id="caixa-confronto"></div>
            </div>
            <div>
                <h4 style="font-size: 12px; text-transform: uppercase; color: #888;">Hist√≥rico Geral</h4>
                <div class="history-box" id="caixa-geral"></div>
            </div>
        </div>

        <div style="margin-top: 50px; padding-bottom: 30px;">
            <button class="btn-reset" onclick="desfazerUltimo()">Anular √öltimo Jogo</button>
            <button class="btn-reset" onclick="zerarTudo()" style="color: #ff005a;">Reset Geral</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBIc5trqvEujQOdpU_VUZtvUGtHPKpF7o8",
            authDomain: "x1-dos-primos69.firebaseapp.com",
            databaseURL: "https://x1-dos-primos69-default-rtdb.firebaseio.com",
            projectId: "x1-dos-primos69",
            appId: "1:202105662518:web:395970a7858318b529bc97"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const nomesJogadores = ["LSHOW69", "CHEIROZIN", "YGOL"];
        
        const gerarDadosIniciais = () => {
            let base = { jogadores: {}, historico: [] };
            nomesJogadores.forEach(n => base.jogadores[n] = { pts: 0, v: 0, e: 0, d: 0, gp: 0, gc: 0 });
            return base;
        };

        let appData = gerarDadosIniciais();

        function trocarFoto(id) {
            const nome = document.getElementById(id).value;
            // Atualizado para procurar .png
            document.getElementById('img-' + id).src = nome + ".png";
        }

        db.ref('arena_v1').on('value', (snap) => {
            const data = snap.val();
            if (data && data.jogadores) {
                appData = data;
                atualizarInterface();
            } else {
                db.ref('arena_v1').set(gerarDadosIniciais());
            }
        });

        function atualizarInterface() {
            const corpo = document.getElementById('tabela-corpo');
            corpo.innerHTML = "";
            const ordenados = Object.entries(appData.jogadores).sort((a,b) => b[1].pts - a[1].pts || (b[1].gp-b[1].gc)-(a[1].gp-a[1].gc));
            
            ordenados.forEach(([nome, d], i) => {
                // Atualizado para usar .png na tabela tamb√©m
                corpo.innerHTML += `<tr>
                    <td>${i+1}</td>
                    <td style="text-align:left"><img src="${nome}.png" class="escudo-tabela"> ${nome}</td>
                    <td style="color:var(--pl-verde); font-size: 18px;">${d.pts}</td>
                    <td>${d.v}</td><td>${d.e}</td><td>${d.d}</td>
                    <td>${d.gp-d.gc}</td>
                </tr>`;
            });

            document.getElementById('caixa-geral').innerHTML = (appData.historico || []).slice().reverse().map(j => `
                <div style="padding:12px; border-bottom:1px solid #222; font-size:13px;">
                    ${j.p1} <span class="score-pill">${j.g1} - ${j.g2}</span> ${j.p2}
                </div>`).join('');
            filtrarConfronto();
        }

        function filtrarConfronto() {
            const f1 = document.getElementById('f1').value;
            const f2 = document.getElementById('f2').value;
            const jogos = (appData.historico || []).filter(j => (j.p1 === f1 && j.p2 === f2) || (j.p1 === f2 && j.p2 === f1));
            
            let s = { g1:0, g2:0, v1:0, v2:0, e:0 };
            jogos.forEach(j => {
                const isF1 = j.p1 === f1;
                s.g1 += isF1 ? j.g1 : j.g2; s.g2 += isF1 ? j.g2 : j.g1;
                const r = isF1 ? (j.g1 > j.g2 ? 1 : j.g1 < j.g2 ? 2 : 0) : (j.g2 > j.g1 ? 1 : j.g2 < j.g1 ? 2 : 0);
                if(r===1) s.v1++; else if(r===2) s.v2++; else s.e++;
            });

            const total = jogos.length;
            const apr1 = total > 0 ? (((s.v1*3+s.e)/(total*3))*100).toFixed(0) : 0;
            const apr2 = total > 0 ? (((s.v2*3+s.e)/(total*3))*100).toFixed(0) : 0;

            document.getElementById('raio-x-container').innerHTML = `
                <div class="stat-item"><span>Gols Marcados (${f1})</span><strong>${s.g1} Gols</strong></div>
                <div class="stat-item"><span>Gols Marcados (${f2})</span><strong>${s.g2} Gols</strong></div>
                <div class="stat-item"><span>Aproveitamento ${f1}</span><strong>${apr1}%</strong></div>
                <div class="stat-item"><span>Aproveitamento ${f2}</span><strong>${apr2}%</strong></div>`;
            
            document.getElementById('caixa-confronto').innerHTML = [...jogos].reverse().map(j => `
                <div style="padding:10px; border-bottom:1px dotted #333;">${j.p1} ${j.g1}x${j.g2} ${j.p2}</div>`).join('');
        }

        function registrarJogo() {
            const p1 = document.getElementById('p1').value, p2 = document.getElementById('p2').value;
            const g1 = parseInt(document.getElementById('gols1').value), g2 = parseInt(document.getElementById('gols2').value);
            if(p1===p2) return alert("Selecione jogadores diferentes!");
            
            processarResultado(p1, g1, p2, g2, 1);
            if(!appData.historico) appData.historico = [];
            appData.historico.push({p1,g1,p2,g2});
            db.ref('arena_v1').set(appData).then(() => {
                document.getElementById('gols1').value = 0;
                document.getElementById('gols2').value = 0;
            });
        }

        function processarResultado(p1, g1, p2, g2, mod) {
            appData.jogadores[p1].gp += (g1*mod); appData.jogadores[p1].gc += (g2*mod);
            appData.jogadores[p2].gp += (g2*mod); appData.jogadores[p2].gc += (g1*mod);
            if(g1 > g2) { appData.jogadores[p1].pts+=(3*mod); appData.jogadores[p1].v+=(1*mod); appData.jogadores[p2].d+=(1*mod); }
            else if(g2 > g1) { appData.jogadores[p2].pts+=(3*mod); appData.jogadores[p2].v+=(1*mod); appData.jogadores[p1].d+=(1*mod); }
            else { appData.jogadores[p1].pts+=(1*mod); appData.jogadores[p1].e+=(1*mod); appData.jogadores[p2].pts+=(1*mod); appData.jogadores[p2].e+=(1*mod); }
        }

        function compartilharZap() {
            let t = `üèÜ X1 DOS PRIMOS | ARENA 2026\n\n`;
            Object.entries(appData.jogadores).sort((a,b)=>b[1].pts-a[1].pts).forEach(([n,d],i)=> {
                t += `${i+1}¬∫ ${n} - ${d.pts} PTS\n`;
            });
            window.open(`https://wa.me/?text=${encodeURIComponent(t)}`);
        }

        function zerarTudo() { if(confirm("Deseja resetar todos os dados?")) db.ref('arena_v1').set(gerarDadosIniciais()); }
        function desfazerUltimo() {
            if(!appData.historico || appData.historico.length === 0) return;
            if(confirm("Anular √∫ltima partida?")) {
                const j = appData.historico.pop();
                processarResultado(j.p1, j.g1, j.p2, j.g2, -1);
                db.ref('arena_v1').set(appData);
            }
        }

        const sels = ['p1', 'p2', 'f1', 'f2'];
        sels.forEach(s => nomesJogadores.forEach(n => document.getElementById(s).innerHTML += `<option value="${n}">${n}</option>`));
        document.getElementById('p2').selectedIndex = 2; document.getElementById('f2').selectedIndex = 2;
        trocarFoto('p1'); trocarFoto('p2');
    </script>
</body>
</html>
